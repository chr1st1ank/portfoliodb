# https://taskfile.dev

version: "3"

tasks:
  makemigrations:
    desc: "Make Django DB migrations"
    cmds:
      - uv run --directory=backend python manage.py makemigrations

  sample-data:
    desc: "Load sample data into DB"
    cmds:
      - rm backend/db.sqlite3
      - uv run --directory=backend python manage.py migrate --noinput
      - uv run --directory=backend python manage.py loaddata sample_data.json
    silent: false

  real-data:
    desc: "Load real data into DB"
    cmds:
      - python local/read_sql.py
      - rm backend/db.sqlite3
      - uv run --directory=backend python manage.py migrate --noinput
      - uv run --directory=backend python manage.py loaddata real_data.json
    silent: false

  start-backend:
    desc: "Start Django backend server"
    cmds:
      - uv run --directory=backend python manage.py migrate --noinput
      - uv run --directory=backend python manage.py runserver 0.0.0.0:8000
    silent: false

  start-frontend:
    desc: "Start Vite frontend development server"
    cmds:
      - cd frontend && npm run dev
    silent: false
